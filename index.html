<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Guru Computer Education Institute - Admission Form</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root{--primary-blue:#1a2a6c;--secondary-blue:#2a4d8e;--light-blue:#e8f4ff;--white:#fff;--gray:#f5f7fa;--dark-gray:#444;--success:#0d8b4e;--whatsapp:#25D366;--accent:#d4af37}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma, Geneva, Verdana, sans-serif}
body{background:linear-gradient(135deg,var(--primary-blue) 0%,var(--secondary-blue) 100%);color:#333;padding:20px;min-height:100vh;line-height:1.6}
.container{max-width:1000px;margin:0 auto;background:var(--white);border-radius:15px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.2)}
header{background:linear-gradient(to right,var(--primary-blue),var(--secondary-blue));color:var(--white);padding:20px;text-align:center}
.institute-name{font-size:24px;font-weight:700;margin-bottom:5px}.address,.contact{font-size:14px;margin:3px 0;opacity:.9}.welcome-message{background:var(--light-blue);padding:15px;border-radius:8px;margin:15px 25px;text-align:center;border-left:4px solid var(--secondary-blue)}.form-container{padding:20px}.form-section{margin-bottom:25px;padding:15px;border-radius:10px;background:var(--gray);border-left:5px solid var(--secondary-blue)}.section-title{font-size:18px;font-weight:600;color:var(--secondary-blue);margin-bottom:15px;display:flex;align-items:center}.form-row{display:flex;flex-wrap:wrap;margin:0 -8px}.form-group{flex:1 0 280px;padding:0 8px;margin-bottom:15px}label{display:block;margin-bottom:6px;font-weight:600;color:var(--dark-gray);font-size:14px}.required::after{content:" *";color:red}input[type="text"],input[type="date"],input[type="email"],input[type="tel"],input[type="number"],textarea,select{width:100%;padding:10px 12px;border:2px solid #ddd;border-radius:6px;font-size:14px}input:focus,textarea:focus,select:focus{border-color:var(--secondary-blue);outline:none}.file-upload{border:2px dashed #ccc;padding:15px;text-align:center;border-radius:6px;background:#f8f9fa;cursor:pointer}.submit-btn{display:block;width:100%;padding:12px;background:var(--success);color:var(--white);border:none;border-radius:6px;font-size:16px;font-weight:600;cursor:pointer;margin-top:15px;transition:all .3s ease}.submit-btn:hover{background:#0a6e3d;transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,0.2)}.submit-btn:disabled{background:#ccc;cursor:not-allowed}.success-message{display:none;text-align:center;padding:40px 30px}.student-id{background:#ecfdf5;color:#065f46;padding:15px 25px;border-radius:10px;font-weight:700;font-size:20px;margin:25px 0;display:inline-block;border:2px solid #a7f3d0;box-shadow:0 4px 8px rgba(0,0,0,0.1)}.footer-note{ text-align:center;margin-top:25px;padding:20px;background:var(--light-blue);border-radius:8px;font-weight:600;color:var(--secondary-blue)}
@media (max-width:768px){.form-group{flex:1 0 100%}.institute-name{font-size:20px}}
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="institute-name">Guru Computer Education Institute</div>
    <div class="address">Near Police Station, Dagori Road, Bilha, Bilaspur (C.G.)</div>
    <div class="contact">Phone: 9244240484</div>
  </header>

  <div class="welcome-message hindi-text">
    <p><strong>Namaste! Main Vani Hoon, Guru Computer Education Institute, Bilha mein aapka swagat hai.</strong></p>
    <p>Kripya admission form bhar kar submit karen. Form verify hone par hum aapko jald hi contact karenge.</p>
  </div>

  <div class="form-container" id="admissionForm">
    <div class="form-section">
      <div class="section-title"><i class="fas fa-user-graduate"></i> Student Details</div>
      <div class="form-row">
        <div class="form-group"><label for="fullName" class="required">Full Name</label><input id="fullName" type="text" /></div>
        <div class="form-group"><label for="fatherName">Father / Guardian Name</label><input id="fatherName" type="text" /></div>
      </div>

      <div class="form-row">
        <div class="form-group"><label for="mobile" class="required">Mobile Number</label><input id="mobile" type="tel" maxlength="10" /></div>
        <div class="form-group"><label for="whatsapp" class="required">WhatsApp Number</label><input id="whatsapp" type="tel" maxlength="10" /></div>
      </div>

      <div class="form-row">
        <div class="form-group"><label for="gender" class="required">Gender</label>
          <select id="gender"><option value="">Select Gender</option><option>Male</option><option>Female</option><option>Other</option></select>
        </div>
        <div class="form-group"><label for="dob">Date of Birth</label><input id="dob" type="date" /></div>
      </div>

      <div class="form-group"><label for="address" class="required">Address</label><textarea id="address" rows="2"></textarea></div>

      <div class="form-row">
        <div class="form-group"><label for="aadhar" class="required">Aadhar Number</label><input id="aadhar" type="text" maxlength="12" /></div>
        <div class="form-group"><label for="email">Email</label><input id="email" type="email" /></div>
      </div>
    </div>

    <div class="form-section">
      <div class="section-title"><i class="fas fa-laptop-code"></i> Course Details</div>
      <div class="form-row">
        <div class="form-group">
          <label for="course" class="required">Select Course</label>
          <select id="course">
            <option value="">Select a course</option>
            <option>Basic Computer Course</option>
            <option>MS Office (Word, Excel, PowerPoint)</option>
            <option>Typing (Hindi + English)</option>
            <option>Internet & Email Training</option>
            <option>Tally Prime with GST</option>
            <option>CCC Course</option>
            <option>DCA Course</option>
            <option>PGDCA Course</option>
            <option>Photoshop (Image Editing + Design Basics)</option>
            <option>Canva Designing Course</option>
            <option>AI Course – How to Use ChatGPT Effectively</option>
          </select>
        </div>
        <div class="form-group">
          <label for="batchTime" class="required">Preferred Batch Time</label>
          <select id="batchTime">
            <option value="">Select Batch Time</option>
            <option>Morning: 7–8 AM</option>
            <option>Morning: 8–9 AM</option>
            <option>Morning: 9–10 AM</option>
            <option>Morning: 10–11 AM</option>
            <option>Evening: 5–6 PM</option>
            <option>Evening: 6–7 PM</option>
          </select>
        </div>
      </div>
    </div>

    <div class="form-section">
      <div class="section-title"><i class="fas fa-file-alt"></i> Required Documents</div>
      <div class="form-row">
        <div class="form-group"><label for="photo" class="required">Passport Size Photo</label><input id="photo" type="file" accept="image/*" /></div>
        <div class="form-group"><label for="aadharCard" class="required">Aadhar Card</label><input id="aadharCard" type="file" accept="image/*,.pdf" /></div>
      </div>
      <div class="form-row"><div class="form-group"><label for="marksheet">Marksheet (Optional)</label><input id="marksheet" type="file" accept="image/*,.pdf" /></div></div>
    </div>

    <div class="footer-note">Guru Ke Saath Gyan, Safalta Ki Pehchan</div>

    <div class="spinner" id="loadingSpinner" style="display:none"></div>
    <button id="submitBtn" class="submit-btn"><i class="fas fa-paper-plane"></i> Submit Admission Form</button>
  </div>

  <div id="successMessage" class="success-message">
    <div class="success-icon">✓</div>
    <h2>Form Submitted Successfully!</h2>
    <p id="successStudentName"></p>
    <div class="student-id" id="studentIdDisplay">Your Student ID: </div>
  </div>
</div>

<script>
/* ==== Paste your deployed Apps Script web app URL here (must end with /exec) ==== */
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzmGNO5OJeDGWdOXqUfD77KaP3_E4PmYIE3EJFXw9x2uMI8ubvZHU5TrzG3HzZyPal1/exec';

/* helpers */
function validateForm() {
  const required = ['fullName','mobile','whatsapp','course','batchTime','address','aadhar','gender'];
  for (let id of required) {
    const el = document.getElementById(id);
    if (!el || !String(el.value || '').trim()) { alert('कृपया सभी आवश्यक फ़ील्ड भरें'); return false; }
  }
  if (!/^\d{10}$/.test(document.getElementById('mobile').value)) { alert('कृपया 10 अंकों का मोबाइल नंबर दर्ज करें'); return false; }
  if (!/^\d{10}$/.test(document.getElementById('whatsapp').value)) { alert('कृपया 10 अंकों का WhatsApp नंबर दर्ज करें'); return false; }
  return true;
}
function generateStudentId() {
  return 'GCEI-' + new Date().getFullYear() + '-' + Math.floor(1000 + Math.random()*9000);
}

/* submit as application/x-www-form-urlencoded to avoid preflight */
async function submitToGoogleSheetsWithFiles() {
  if (!validateForm()) return;

  document.getElementById('loadingSpinner').style.display = 'block';
  document.getElementById('submitBtn').disabled = true;

  const studentId = generateStudentId();
  const params = new URLSearchParams();
  params.append('studentId', studentId);
  params.append('fullName', document.getElementById('fullName').value.trim());
  params.append('fatherName', document.getElementById('fatherName').value.trim());
  params.append('mobile', document.getElementById('mobile').value.trim());
  params.append('whatsapp', document.getElementById('whatsapp').value.trim());
  params.append('gender', document.getElementById('gender').value);
  params.append('dob', document.getElementById('dob').value || '');
  params.append('address', document.getElementById('address').value.trim());
  params.append('aadhar', document.getElementById('aadhar').value.trim());
  params.append('email', document.getElementById('email').value.trim());
  params.append('course', document.getElementById('course').value);
  params.append('batchTime', document.getElementById('batchTime').value);

  try {
    const resp = await fetch(GOOGLE_SCRIPT_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: params.toString()
    });

    if (!resp.ok) {
      const txt = await resp.text();
      throw new Error('Server returned ' + resp.status + ' — ' + txt);
    }

    const text = await resp.text();
    let result = {};
    try { result = JSON.parse(text); } catch (e) { result = { status: 'ok' }; }

    if (result.status === 'success' || result.status === 'ok') {
      document.getElementById('admissionForm').style.display = 'none';
      document.getElementById('successMessage').style.display = 'block';
      document.getElementById('studentIdDisplay').textContent = 'Your Student ID: ' + studentId;
      document.getElementById('successStudentName').textContent = 'धन्यवाद, ' + document.getElementById('fullName').value + '! आपका फॉर्म जमा हो गया है।';
    } else {
      alert('Submission failed: ' + (result.message || text || 'Unknown'));
    }
  } catch (err) {
    alert('Submission error: ' + err.message);
    console.error(err);
  } finally {
    document.getElementById('loadingSpinner').style.display = 'none';
    document.getElementById('submitBtn').disabled = false;
  }
}

/* bind */
document.getElementById('submitBtn').addEventListener('click', function(e){
  e.preventDefault();
  submitToGoogleSheetsWithFiles();
});

/* DOB max (min age 10) */
(function setDobMax(){
  const dob = document.getElementById('dob');
  const today = new Date();
  dob.max = new Date(today.getFullYear()-10, today.getMonth(), today.getDate()).toISOString().split('T')[0];
})();
</script>
</body>
</html>
